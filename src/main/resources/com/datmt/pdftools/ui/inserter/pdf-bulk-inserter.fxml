<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns:fx="http://javafx.com/fxml"
            xmlns="http://javafx.com/javafx"
            fx:controller="com.datmt.pdftools.ui.inserter.PdfBulkInserterController"
            style="-fx-font-family: 'Segoe UI';">

    <!-- Top Toolbar -->
    <top>
        <ToolBar style="-fx-background-color: #f0f0f0; -fx-padding: 8;">
            <Button fx:id="selectSourceButton" text="Select Insert Source" onAction="#onSelectSource"
                    style="-fx-font-size: 13;"/>
            <Label fx:id="sourceFileLabel" text="No source selected"
                   style="-fx-font-size: 13; -fx-text-fill: #666666; -fx-padding: 0 0 0 10;"/>
            <Pane HBox.hgrow="ALWAYS"/>
            <Button fx:id="insertAllButton" text="Insert All" onAction="#onInsertAll"
                    style="-fx-font-size: 14; -fx-font-weight: bold; -fx-background-color: #4CAF50; -fx-text-fill: white; -fx-padding: 8 20;"
                    disable="true"/>
        </ToolBar>
    </top>

    <!-- Main Content -->
    <center>
        <HBox spacing="20" style="-fx-padding: 20;">

            <!-- Left: Target Files List -->
            <VBox spacing="10" HBox.hgrow="ALWAYS" minWidth="450">
                <Label text="Target PDF Files" style="-fx-font-size: 16; -fx-font-weight: bold;"/>

                <HBox spacing="10">
                    <Button fx:id="addFilesButton" text="Add Files" onAction="#onAddFiles"
                            style="-fx-font-size: 12;"/>
                    <Button fx:id="removeFileButton" text="Remove" onAction="#onRemoveFile"
                            style="-fx-font-size: 12;" disable="true"/>
                    <Button fx:id="clearAllButton" text="Clear All" onAction="#onClearAll"
                            style="-fx-font-size: 12;" disable="true"/>
                </HBox>

                <ScrollPane fx:id="filesScrollPane" VBox.vgrow="ALWAYS"
                            style="-fx-background-color: white; -fx-border-color: #cccccc; -fx-border-radius: 4;">
                    <VBox fx:id="filesContainer" spacing="5" style="-fx-padding: 10;">
                        <!-- Target file items will be added here -->
                    </VBox>
                </ScrollPane>

                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label fx:id="totalTargetsLabel" text="Total: 0 files"
                           style="-fx-font-size: 13; -fx-text-fill: #666666;"/>
                </HBox>

                <!-- Results Section -->
                <VBox fx:id="resultsSection" spacing="10" visible="false" managed="false"
                      style="-fx-padding: 15; -fx-background-color: #f5f5f5; -fx-border-color: #cccccc; -fx-border-radius: 4;">
                    <Label text="Insertion Results" style="-fx-font-size: 14; -fx-font-weight: bold;"/>
                    <ScrollPane fx:id="resultsScrollPane" maxHeight="150"
                                style="-fx-background-color: transparent;">
                        <VBox fx:id="resultsContainer" spacing="3"/>
                    </ScrollPane>
                    <Separator/>
                    <HBox spacing="20" alignment="CENTER_LEFT">
                        <Label fx:id="totalSuccessLabel" text="Success: 0" style="-fx-font-size: 13;"/>
                        <Label fx:id="totalFailedLabel" text="Failed: 0" style="-fx-font-size: 13;"/>
                        <Label fx:id="totalInsertionsLabel" text="Insertions: 0"
                               style="-fx-font-size: 13; -fx-font-weight: bold; -fx-text-fill: #4CAF50;"/>
                    </HBox>
                </VBox>
            </VBox>

            <!-- Right: Settings -->
            <VBox spacing="15" minWidth="280" maxWidth="280">

                <!-- Source Preview Section -->
                <VBox spacing="10" style="-fx-padding: 15; -fx-background-color: #f5f5f5; -fx-border-color: #cccccc; -fx-border-radius: 4;">
                    <Label text="Insert Source" style="-fx-font-size: 13; -fx-font-weight: bold;"/>
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <StackPane style="-fx-background-color: #e0e0e0; -fx-border-color: #cccccc;"
                                   minWidth="80" minHeight="100" maxWidth="80" maxHeight="100">
                            <ImageView fx:id="sourcePreviewImage" fitWidth="80" fitHeight="100" preserveRatio="true"/>
                            <Label fx:id="noSourceLabel" text="No source" style="-fx-text-fill: #999999;"/>
                        </StackPane>
                        <VBox spacing="3">
                            <Label fx:id="sourceNameLabel" text="-" style="-fx-font-size: 12;" wrapText="true" maxWidth="170"/>
                            <Label fx:id="sourceInfoLabel" text="-" style="-fx-font-size: 11; -fx-text-fill: #666666;"/>
                        </VBox>
                    </HBox>
                </VBox>

                <!-- Insertion Mode Section -->
                <VBox spacing="10" style="-fx-padding: 15; -fx-background-color: #f5f5f5; -fx-border-color: #cccccc; -fx-border-radius: 4;">
                    <Label text="Insertion Mode" style="-fx-font-size: 13; -fx-font-weight: bold;"/>

                    <RadioButton fx:id="atEndRadio" text="At the end of each PDF" selected="true"
                                 style="-fx-font-size: 12;">
                        <toggleGroup>
                            <ToggleGroup fx:id="insertionModeGroup"/>
                        </toggleGroup>
                    </RadioButton>

                    <RadioButton fx:id="afterPageRadio" text="After specific page"
                                 toggleGroup="$insertionModeGroup"
                                 style="-fx-font-size: 12;"/>
                    <HBox fx:id="afterPageOptions" spacing="10" alignment="CENTER_LEFT" disable="true"
                          style="-fx-padding: 0 0 0 20;">
                        <Label text="Page:" style="-fx-font-size: 11;"/>
                        <Spinner fx:id="afterPageSpinner" editable="true" prefWidth="80">
                            <valueFactory>
                                <SpinnerValueFactory.IntegerSpinnerValueFactory min="1" max="9999" initialValue="1"/>
                            </valueFactory>
                        </Spinner>
                    </HBox>

                    <RadioButton fx:id="everyNPagesRadio" text="Every N pages"
                                 toggleGroup="$insertionModeGroup"
                                 style="-fx-font-size: 12;"/>
                    <HBox fx:id="everyNPagesOptions" spacing="10" alignment="CENTER_LEFT" disable="true"
                          style="-fx-padding: 0 0 0 20;">
                        <Label text="Every:" style="-fx-font-size: 11;"/>
                        <Spinner fx:id="everyNPagesSpinner" editable="true" prefWidth="80">
                            <valueFactory>
                                <SpinnerValueFactory.IntegerSpinnerValueFactory min="1" max="9999" initialValue="10"/>
                            </valueFactory>
                        </Spinner>
                        <Label text="pages" style="-fx-font-size: 11;"/>
                    </HBox>

                    <Separator/>
                    <CheckBox fx:id="insertAtEndIfShorterCheck" text="If PDF shorter, insert at end" selected="true"
                              style="-fx-font-size: 11;"/>
                </VBox>

                <!-- Image Options Section (only for image sources) -->
                <VBox fx:id="imageOptionsPane" spacing="10" visible="false" managed="false"
                      style="-fx-padding: 15; -fx-background-color: #f5f5f5; -fx-border-color: #cccccc; -fx-border-radius: 4;">
                    <Label text="Image Options" style="-fx-font-size: 13; -fx-font-weight: bold;"/>
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Page size:" style="-fx-font-size: 11;" minWidth="70"/>
                        <ComboBox fx:id="pageSizeCombo" prefWidth="150"/>
                    </HBox>
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Fit option:" style="-fx-font-size: 11;" minWidth="70"/>
                        <ComboBox fx:id="fitOptionCombo" prefWidth="150"/>
                    </HBox>
                </VBox>

                <!-- Output Section -->
                <VBox spacing="10" style="-fx-padding: 15; -fx-background-color: #f5f5f5; -fx-border-color: #cccccc; -fx-border-radius: 4;">
                    <Label text="Output" style="-fx-font-size: 13; -fx-font-weight: bold;"/>
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Suffix:" style="-fx-font-size: 11;"/>
                        <TextField fx:id="suffixField" text="_modified" prefWidth="150"
                                   style="-fx-font-size: 11;"/>
                    </HBox>
                    <Label text="Output: filename_modified.pdf"
                           style="-fx-font-size: 10; -fx-text-fill: #888888;"/>
                </VBox>

                <!-- Progress -->
                <VBox fx:id="progressSection" spacing="5" visible="false" managed="false"
                      style="-fx-padding: 15; -fx-background-color: #e3f2fd; -fx-border-color: #2196F3; -fx-border-radius: 4;">
                    <Label fx:id="progressLabel" text="Inserting..."
                           style="-fx-font-size: 13; -fx-font-weight: bold;"/>
                    <ProgressBar fx:id="progressBar" progress="0" prefWidth="250"/>
                    <Label fx:id="progressDetailLabel" text=""
                           style="-fx-font-size: 11; -fx-text-fill: #666666;"/>
                </VBox>
            </VBox>
        </HBox>
    </center>

    <bottom>
        <HBox alignment="CENTER" style="-fx-padding: 8; -fx-background-color: #f5f5f5; -fx-border-color: #e0e0e0; -fx-border-width: 1 0 0 0;">
            <Label text="Discover more awesome tools at " style="-fx-font-size: 11; -fx-text-fill: #666666;"/>
            <Hyperlink fx:id="creditLink" text="tools.datmt.com" style="-fx-font-size: 11;"/>
        </HBox>
    </bottom>
</BorderPane>
